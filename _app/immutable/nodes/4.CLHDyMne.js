import"../chunks/DsnmJJEf.js";import"../chunks/5UPRGOmn.js";import{o as D,h as G,s as w,e as A}from"../chunks/BOOa181H.js";import{Y as m,k as t,a4 as H,p as J,f as k,a as x,b as c,c as K,$ as Q,s as d,d as r,_ as C,r as s,t as I,a5 as E}from"../chunks/YEsR6uFO.js";import{i as P}from"../chunks/C7VAiwEf.js";import{s as T}from"../chunks/D1LHmu9n.js";import{i as V}from"../chunks/BtaoUuZt.js";import{N as W}from"../chunks/iEZU9Woh.js";import{b as F,S as X,f as Z}from"../chunks/87qpYtHj.js";import{p as aa}from"../chunks/CSVxk9od.js";function ea(h){var u=H(0);return function(){return arguments.length===1?(m(u,t(u)+1),arguments[0]):(t(u),h())}}var n=ea(()=>X),ta=k('<div class="user-info svelte-10k5bz7"><img alt="Profile" class="svelte-10k5bz7"/> <div><div class="name svelte-10k5bz7"> </div> <div class="email svelte-10k5bz7"> </div></div></div> <div class="actions svelte-10k5bz7"><button class="primary svelte-10k5bz7">Sign out</button></div>',1),ra=k('<div class="error svelte-10k5bz7"> </div>'),sa=k('<div class="actions svelte-10k5bz7"><button class="primary svelte-10k5bz7"><!></button></div> <!>',1),ia=k('<!> <main class="login-page svelte-10k5bz7"><div class="container svelte-10k5bz7"><div class="card svelte-10k5bz7"><h2>Sign in to CCPorted</h2> <p>Access account features like favorites and sync.</p> <!></div></div></main>',1);function pa(h,u){J(u,!1);let o=C(null),p=C(!1),z=C(null);async function L(){try{m(p,!0),await Z(aa.url)}catch(a){m(z,a instanceof Error?a.message:String(a))}finally{m(p,!1)}}async function O(){try{await F(window.location.origin).removeUser(),m(o,null),n(n().user=null),n(n().loggedIn=!1)}catch(a){console.error(a)}}D(async()=>{try{const a=await F(window.location.origin).getUser();a&&(m(o,a.profile||a),n(n().user=t(o)),n(n().loggedIn=!0))}catch(a){console.error("Failed to get user",a)}}),V();var U=ia();G(a=>{Q.title="Login - CCPorted"});var M=x(U);W(M,{});var N=d(M,2),$=r(N),q=r($),R=d(r(q),4);{var Y=a=>{var f=ta(),v=x(f),l=r(v),_=d(l,2),g=r(_),y=r(g,!0);s(g);var b=d(g,2),S=r(b,!0);s(b),s(_),s(v);var e=d(v,2),i=r(e);s(e),I(()=>{T(l,"src",t(o).picture||"/static/profile_pic.png"),w(y,t(o).name||t(o).email),w(S,t(o).email)}),A("click",i,O),c(a,f)},j=a=>{var f=sa(),v=x(f),l=r(v),_=r(l);{var g=e=>{var i=E("Signing in...");c(e,i)},y=e=>{var i=E("Sign in with Cognito");c(e,i)};P(_,e=>{t(p)?e(g):e(y,!1)})}s(l),s(v);var b=d(v,2);{var S=e=>{var i=ra(),B=r(i,!0);s(i),I(()=>w(B,t(z))),c(e,i)};P(b,e=>{t(z)&&e(S)})}I(()=>l.disabled=t(p)),A("click",l,L),c(a,f)};P(R,a=>{t(o)?a(Y):a(j,!1)})}s(q),s($),s(N),c(h,U),K()}export{pa as component};
